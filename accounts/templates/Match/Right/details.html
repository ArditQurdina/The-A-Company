{% load static %}
<style>
    button{
        border:0px;
        background-color: transparent;
    }
    .overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.7);
  z-index: 1;
}

/* CSS for the popup */
.popup {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: white;
  padding: 20px;
  border: 1px solid #ccc;
  border-radius: 20px;
  z-index: 2;
}

#drop-area {
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            font-size: 1.2em;
            cursor: pointer;
        }
</style>
<div class="right-jobs-main-div right-job-margin-top">
        <div class="right-jobs" id="detailsRow" style="flex-direction: column;">
            <div class="job-right-details" style=" ">
        <div class="job-right-content" style="width: 100%;">
            <div class="job-left-title job-right-title" id="" >Document for Work Permit</div>
            <div class="job-left-details" id="documents">
                {% if not passaportExists %}
                <span class="job-left-salary"  style="color:gray  !important; ">Passaport <button class="open-popup" data-number="1" style="float:right;">⬆️</button></span><br><br>
                {% else %}
                <span class="job-left-salary" >Passaport <button class="open-popup" data-number="1" style="float:right;">⬇️</button></span><br><br>
                {% endif %}
                {% if not studentStatusExists %}

                <span class="job-left-salary"  style="color:gray  !important;">Student status <button class="open-popup" data-number="2" style="float:right;">⬆️</button></span><br><br>
                <input type="hidden"></input>
                {% else %}
                <span class="job-left-salary" id="">Student status <button class="open-popup" data-number="2" style="float:right;">⬇️</button></span><br><br>

                {% endif %}

                {% if not certificateOfEnrolmentExists%}
                <span class="job-left-salary" style="color:gray !important;">Certificate of Enrolment <button class="open-popup" data-number="3" style="float:right;">⬆️</button></span><br><br>
                {% else %}
                <span class="job-left-salary" >Certificate of Enrolment <button class="open-popup" data-number="3" style="float:right;">⬇️</button></span><br><br>
                {% endif %}


                {% if not studetIdExists %}
                <span class="job-left-salary" style="color:gray !important;">Student ID <button class="open-popup" style="float:right;" data-number="4">⬆️</button></span><br><br>
                {% else %}
                <span class="job-left-salary" >Student ID <button class="open-popup" style="float:right;" data-number="4">⬇️</button></span><br><br>
                {% endif %}




                {% if not photoExists %}
                <span class="job-left-salary"   style="color:gray !important;">Photo <button class="open-popup" style="float:right;" data-number="5">⬆️</button></span><br><br>
                {% else %}
                <span class="job-left-salary" >Photo <button class="open-popup" style="float:right;" data-number="5">⬇️</button></span><br><br>
                {% endif %}


                {% if not resumeExists %}
                <span class="job-left-salary"   style="color:gray !important;">Resume <button class="open-popup" style="float:right;" data-number="6">⬆️</button></span><br><br>
                {% else %}
                <span class="job-left-salary" >Resume <button class="open-popup" style="float:right;" data-number="6">⬇️</button></span><br><br>
                {% endif %}


                {% if not serviceContractExists %}
                <span class="job-left-salary"  style="color:gray !important;">Service Contract <button class="open-popup" style="float:right;" data-number="7">⬆️</button></span><br>
                {% else %}
                <span class="job-left-salary" >Service Contract <button class="open-popup" style="float:right;" data-number="7">⬇️</button></span><br>
                {% endif %}

              </div>

        </div>

    </div>
            <div class="job-right-details" style="margin-top:20px; ">
                <div class="job-right-content" style="">
                        <img class="myjob-right-exit " title="Exit" style=""
                            src="{% static 'img/Vector 81 (1).png'%}" onclick="closeButton()" alt="">
                        <div class="job-left-title job-right-title" id="fname"></div>
                        <div class="second-row-jobs mobile-under-title-font-size" id="Stat"></div>
                        <div style="" class="jobs-third-row mobile-rows-font-size" id="email"></div>
                        <div style="" class="experience-fourth-row jobs-mutual-margin-rows mobile-rows-font-size" id="phone">
                        </div>
                        <div style="" class="experience-fourth-row jobs-mutual-margin-rows mobile-rows-font-size" id="location"></div>
                        <div style="" class="experience-fourth-row jobs-mutual-margin-rows mobile-rows-font-size" >Applied on: <span id="appdate"></span></div>
                        <div style="" class="experience-fourth-row jobs-mutual-margin-rows mobile-rows-font-size" ><span id="meetingTime"></span>&nbsp;&nbsp;<span id="meetingLink"></span></div>

                        <div style="" class="experience-fourth-row jobs-mutual-margin-rows mobile-rows-font-size" > <span id="cv"></span></div>
                </div>
            </div>
            <div class="move"></div>
            <div class="job-right-details" >
                <div class="job-right-content">
                    <div class="experience-paragraph-img-rows" id="UserExp" style="padding:0;">
                        <div class="aaa">
                            <p class="experience-paragraph">Experience</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="move"></div>

            <div class="job-right-details">
                    <div class="job-right-content">
                        <div class="experience-paragraph-img-rows" id="UserEdu" style="padding:0;">
                            <div class="aaa">
                            <p class="experience-paragraph">Education</p>
                        </div>
                        </div>
                    </div>
            </div>
            <div class="move"></div>

             <div class="job-right-details">
                    <div class="job-right-content" >
                        <div class="languages-paragraphs-div" id="UserLang" style="padding:0;">
                            <div class="experience-paragraph language-paragraph">Languages</div>

                        </div>
                    </div>
             </div>

        </div>
</div>









<div class="overlay">
    <div class="popup">

      <form id="upload-form-recruiter" enctype="multipart/form-data">
        {% csrf_token %}


      <div id="drop-area">
        <i class="fa fa-cloud-upload" style="font-size: xxx-large;"></i>
        <p>Drag & Drop a file here or click to select a file</p>
        <input type="file"  name="document" id="id_document"  accept=".pdf, .jpg, .jpeg, .png, .svg"  style="display: none;">
    </div>




        <p style="display:none;" id="error">file not supported</p>

        <input type="hidden" name="document_id" id="document_id" >
        <input type="hidden" name="user_id" id="user_id">
        <div class="save-button save-button-edit-profile-photo save-button-add-education" style="margin-top:20px;">
            <input name="back" id="close-popup" title="Back to Profile" type="button" class="back-input font-fam back-save-buttons" value="Back">
            <button title="Save Profile Data" name="save" type="submit" id="upload-button"   class="save-submit-input font-fam back-save-buttons" value="Save">Save</button>
        </div>


      </form>
      <div id="status"></div>
    </div>
  </div>
  <script>
    const dropArea = document.getElementById('drop-area');
    const fileInput = document.getElementById('id_document');
    const fileList = document.querySelector('#file-list ul');
    let uploadedFile = null;

    dropArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        dropArea.style.backgroundColor = '#f0f0f0';
    });

    dropArea.addEventListener('dragleave', () => {
        dropArea.style.backgroundColor = '#ffffff';
    });

    dropArea.addEventListener('drop', (e) => {
        e.preventDefault();
        dropArea.style.backgroundColor = '#ffffff';
        const file = e.dataTransfer.files[0];
        handleFile(file);
    });

    fileInput.addEventListener('change', () => {
        const file = fileInput.files[0];
        handleFile(file);
    });

    function handleFile(file) {
        // Clear previously uploaded file
        fileList.innerHTML = '';
        uploadedFile = null;

        if (file) {
            const listItem = document.createElement('li');
            listItem.textContent = `${file.name} (${formatSize(file.size)})`;
            fileList.appendChild(listItem);
            uploadedFile = file;
        }
    }

    function formatSize(bytes) {
        if (bytes < 1024) {
            return bytes + " bytes";
        } else if (bytes < 1048576) {
            return (bytes / 1024).toFixed(1) + " KB";
        } else if (bytes < 1073741824) {
            return (bytes / 1048576).toFixed(1) + " MB";
        } else {
            return (bytes / 1073741824).toFixed(1) + " GB";
        }
    }

    // Add a click event listener to the drop area to trigger the file input
    dropArea.addEventListener('click', () => {
        fileInput.click();
    });
</script>
<script>
    $(document).ready(function() {
        $('.open-popup').click(function() {
            var number = $(this).data('number'); // Get the number from the data attribute of the clicked button
            $('#document_id').val(number); // Set the value of the input field in your popup
            $('.overlay').show();
            $('.popup').show();
        });

      $('#close-popup').click(function() {
        $('.overlay').hide();
        $('.popup').hide();
      });

      $('#id_document').on('change', function() {
        var fileInput = this.files[0];

        if (fileInput) {
          // Check the file extension
          var allowedExtensions = ['.pdf', '.jpg', '.jpeg', '.png', '.svg'];
          var fileExtension = fileInput.name.slice(((fileInput.name.lastIndexOf(".") - 1) >>> 0) + 2);
          if (allowedExtensions.indexOf('.' + fileExtension.toLowerCase()) === -1) {
            // Invalid file extension, update the input border color
            $('#id_document').css('border', '2px solid red');
            $('#error').css('display', 'block');
            $('#error').css('color', 'red');
          } else {
            // Reset the input border color if the file is valid
            $('#error').css('display', 'none');

            $('#id_document').css('border', '1px solid #ffff');
          }
        }
      });

      $('#upload-form-recruiter').submit(function(e) {
        e.preventDefault();

        var formData = new FormData(this);

        $.ajax({
          type: 'POST',
          url: '/upload_documents_recruiter/',
          data: formData,
          processData: false,
          contentType: false,
          success: function(response) {
            $('.overlay').hide();
            $('.popup').hide();
          },
          error: function(response) {
            $('#status').text(response.responseJSON.error);
          }
        });
      });
    });
    </script>









