{% load static %}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>
<style>
    form{
        margin-bottom: 0;
    }

    #countrySelect {
        margin-top: 20px;
    }
    .iti{
        width:100% !important;
        margin-bottom: 20px;
    }
    .iti__selected-flag {
        padding: 0 5px 0 10px ;
    }
    .iti--allow-dropdown input {
        padding-left: 49px !important;
    }
</style>



<!-- Edit profile -->
<div class="edit-profile-bg">
        <div class="container-edit-profile under-container-mutual-mutual-stats">

            <div class="edit-profile-title mutual-titles-pop-ups-stats">Edit Profile</div>
            <form method="post" autocomplete="off" enctype="multipart/form-data" class="sign-up-form edit-profile-form forms-inputs-placeholder">
                {% csrf_token %}

                 <div class="first-and-last-name-div" style="">
                        <div class="edit-profile-first-name edit-profile-first-last">
                        {{form.first_name}}
                        </div>

                        <div class="edit-profile-first-last">
                        {{form.last_name}}
                        </div>
                 </div>


                <div>
                            <div class="autocomplete" style="width:100%;">
                                {{form.country}}
                            </div>
                        </div>
                        <div>
                        {{ form.city }}
                        </div>
                        {{form.phone_number}}                        

                <div class="save-button save-button-edit-profile-photo">
                            <input name="back" title="Back to Profile" type="button" class="back-input font-fam back-save-buttons" value="Back">
                            <input title="Save Profile Data" name="save" type="submit" class="save-submit-input font-fam back-save-buttons" value="Save">
                        </div>


            </form>
    </div>
</div>

<!-- edit cover -->
<div class="bg-cover-edit">
    <div class="cover-edit">
        <div class="edit-profile-title mutual-titles-pop-ups-stats edit-profile-cover-photo-title">Edit Cover Photo</div>

        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="div-of-changed-cover">
                <div style="display: none;">
                    
                    <input type="hidden" name="first_name" id="id_first_name" class="profile-all-inputs-option" value="{{form.first_name.value}}"/>
                    <input type="hidden" name="last_name" id="id_last_name" class="profile-all-inputs-option" value="{{form.last_name.value}}"/>
                    <input type="hidden" name="country" id="id_country" class="profile-all-inputs-option" value="{{form.country.value}}"/>
                    <input type="hidden" name="city" id="id_city" class="profile-all-inputs-option" value="{{form.city.value}}"/>
                    <input type="hidden" name="phone_number" id="id_phone_number" class="profile-all-inputs-option" value="{{form.phone_number.value}}"/>

                </div>

                <label for="id_cover">
                    <img class="changed-cover" id="coverPic" height="250"  src="{{user.cover.url}}" title="Profile Cover" alt="" accept="image/*" size="20971520">
                </label>
                {{form.cover}}
            </div>
                <div class="save-button save-button-edit-profile-photo">
                    <input name="back" title="Back to Profile" type="button" class="back-input font-fam back-save-buttons" value="Back">
                    <input title="Save Profile Data" name="save" type="submit" class="save-submit-input font-fam back-save-buttons" value="Save">
                </div>
        </form>


    </div>
</div>



<!-- edit profile -->
<div class="bg-change-profile-picture">
        <div class="change-profile-picture">

            <div class="edit-profile-title mutual-titles-pop-ups-stats edit-profile-cover-photo-title">Edit Profile Photo</div>
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="div-of-changed-cover">
                    <div style="display: none;">
                        <input type="hidden" name="first_name" id="id_first_name" class="profile-all-inputs-option" value="{{form.first_name.value}}"/>
                    <input type="hidden" name="last_name" id="id_last_name" class="profile-all-inputs-option" value="{{form.last_name.value}}"/>
                    <input type="hidden" name="country" id="id_country" class="profile-all-inputs-option" value="{{form.country.value}}"/>
                    <input type="hidden" name="city" id="id_city" class="profile-all-inputs-option" value="{{form.city.value}}"/>
                    <input type="hidden" name="phone_number" id="id_phone_number" class="profile-all-inputs-option" value="{{form.phone_number.value}}"/>

                    </div>

                    <label for="id_profile">
                        <img class="changed-profile changed-picture proImg" id="profilePic"  src="{{user.profile.url}}" title="Profile Cover" alt="">

                    </label>
                    {{form.profile}}
                </div>
                <div class="save-button save-button-edit-profile-photo">
                    <input name="back" title="Back to Profile" type="button" class="back-input font-fam back-save-buttons" value="Back">
                    <input title="Save Profile Data" name="save" type="submit" class="save-submit-input font-fam back-save-buttons" value="Save">
                </div>
            </form>

        </div>
    </div>



<!-- add experience , education, languge -->
<div class="bg-add-and-edit">


    <!-- Add Experience -->
    <div class="add-experience under-container-mutual-mutual-stats">
            <div class="mutual-titles-pop-ups-stats">Add Experience</div>
            <form method="post" class="sign-up-form" enctype="multipart/form-data" style="margin-bottom:0;">
                {% csrf_token %}
                <div style="display: none;">
                    {{form}}
                    {{for_usExp.user_id}}
                </div>
                    {{for_usExp.title}}
                    {{for_usExp.company}}
                    {{for_usExp.Country}}
                    {{for_usExp.city_usExp}}
                    <div class="start-and-end-date-main-div">
                        <input id="id_start_date" class="start-date-input date-of-birth-input inputs-job-details start-end-date all-inputs profile-all-inputs-option"
                        name="start_date" onchange="checkForm();checkStartDate();" value="" type="text" maxlength="10"
                        placeholder="Start Date (mm/dd/yyyy)" oninput="this.value = MMDDYYYY(this.value, event)" />
                        <input id="id_end_date" class="end-date-input date-of-birth-input inputs-job-details start-end-date all-inputs profile-all-inputs-option"
                        name="end_date" onchange="checkForm();checkStartDate();" value="" type="text" maxlength="10"
                        placeholder="End Date (mm/dd/yyyy)" oninput="this.value = MMDDYYYY(this.value, event)" />
                        
                    </div>
                    <div style="float: right; border:0;width:auto;font-size: 16px;color: #858585;padding:0;" class="profile-all-inputs-option">
                        <label class="" style=""><input class="" style="" onchange="present()"type="checkbox" > Present</label>
                    </div>
                    <div class="save-button save-button-edit-profile-photo">
                    <input name="back" title="Back to Profile" type="button"   class="back-input font-fam back-save-buttons" value="Back">
                    <input title="Save Profile Data" name="save" type="submit" class="save-submit-input font-fam back-save-buttons" value="Save">
                </div>
            </form>
    </div>

    <!-- add Education -->
    <div class="add-education edit-education-parent-scroll under-container-mutual-mutual-stats edit-education-scroll">
        <div class="add-education-title mutual-titles-pop-ups-stats">Add Education</div>
        <form method="POST" action="" class="sign-up-form forms-inputs-placeholder">
            {% csrf_token %}
            <div style="display: none;">
                <input type="hidden" name="first_name" id="id_first_name" class="profile-all-inputs-option" value="{{form.first_name.value}}"/>
                    <input type="hidden" name="last_name" id="id_last_name" class="profile-all-inputs-option" value="{{form.last_name.value}}"/>
                    <input type="hidden" name="country" id="id_country" class="profile-all-inputs-option" value="{{form.country.value}}"/>
                    <input type="hidden" name="city" id="id_city" class="profile-all-inputs-option" value="{{form.city.value}}"/>
                    <input type="hidden" name="phone_number" id="id_phone_number" class="profile-all-inputs-option" value="{{form.phone_number.value}}"/>
                    {{form.cover}}
                    {{form.profile}}
                {{form_usEdu.user_id}}
            </div>
            {{form_usEdu.university}}
            {{form_usEdu.field_of_study}}
            
            <select name="degree" required="" id="id_degree" class="profile-all-inputs-option">
                <option style="display: none;" selected>Degree</option>
                <option value="Bachelor" >Bachelor’s Degree</option>

                <option value="Master" >Master’s Degree</option>
            </select>
            
            {{form_usEdu.country_e}}
            
            {{form_usEdu.city_e}}
            
            <input type="number" name="total_examples_passed" value="" class="name-input profile-all-inputs-option" placeholder="Total Exams Passed" required="" id="id_total_examples_passed">
            
            <input type="number" name="GPA" value="" class="name-input profile-all-inputs-option" placeholder="GPA" step="any" required="" id="id_GPA">
            

            <div class="start-and-end-date-main-div">
                <input id="id_start_year" class="start-date-input date-of-birth-input inputs-job-details start-end-date all-inputs mutual-input" 
                name="start_year" onchange="checkForm();checkStartDate();" value="" type="text" maxlength="10" 
                placeholder="Start Year (mm/dd/yyyy)" oninput="this.value = MMDDYYYY(this.value, event)" />
                <input id="id_end_year" class="end-date-input date-of-birth-input inputs-job-details start-end-date all-inputs mutual-input" 
                name="end_year" onchange="checkForm();checkStartDate();" value="" type="text" maxlength="10" 
                placeholder="End Year (mm/dd/yyyy)" oninput="this.value = MMDDYYYY(this.value, event)" />
                
            </div>
            <div style="float: right; border:0;width:auto;font-size: 16px;color: #858585;padding:0;" class="profile-all-inputs-option">
                <label class="" style=""><input class="" style="" onchange="presentEnd()"type="checkbox" > Present</label>
            </div>
            <div class="save-button save-button-edit-profile-photo save-button-add-education">
                <input name="back" title="Back to Profile" type="button" class="back-input font-fam back-save-buttons" value="Back">
                <input title="Save Profile Data" name="save" type="submit" class="save-submit-input font-fam back-save-buttons" value="Save">
            </div>

        </form>
    </div>




<div class="add-languages under-container-mutual-mutual-stats">
 
    <div class="add-language-title mutual-titles-pop-ups-stats">Add Language</div>
    <form method="POST" action="" class="sign-up-form add-language-form">
        {% csrf_token %}
        <div style="display: none;">
            <input type="hidden" name="first_name" id="id_first_name" class="profile-all-inputs-option" value="{{form.first_name.value}}"/>
                    <input type="hidden" name="last_name" id="id_last_name" class="profile-all-inputs-option" value="{{form.last_name.value}}"/>
                    <input type="hidden" name="country" id="id_country" class="profile-all-inputs-option" value="{{form.country.value}}"/>
                    <input type="hidden" name="city" id="id_city" class="profile-all-inputs-option" value="{{form.city.value}}"/>
                    <input type="hidden" name="phone_number" id="id_phone_number" class="profile-all-inputs-option" value="{{form.phone_number.value}}"/>
                    {{form.cover}}
                    {{form.profile}}
            {{form_usLang.user_id}}
        </div>
        <div class="div-of-job-experience">
            <select name="language" required="" id="id_language" class="profile-all-inputs-option">
                <option style="display: none;" selected>Language</option>
                {% for i in lang %}
                    <option value="{{i.id}}">{{i}}</option>
                {% endfor %}
            </select>
        </div>
        
        <div>
        <select id="id_level" name="level" type="text" required class="surname-input mutual-stats font-fam">
            <option style="display: none;" selected>Level</option>   
            <option value="N/A">N/A</option>
                <option value="Basic">Basic</option>
                <option value="Low-Intermediate">Low-Intermediate</option>


                <option value="High-Intermediate">High-Intermediate</option>

                <option value="Advanced">Advanced</option>
        </select>
        </div>
        <div class="save-button save-button-edit-profile">
            <input title="Back to Profile" name="back" type="button" class="back-input font-fam back-save-buttons" value="Back">
            <input title="Save Profile Data" name="save" type="submit" class="save-submit-input font-fam back-save-buttons" value="Save">
        </div>
    </form>
</div>


</div>


<script>
    function addPlusPrefix(input) {
        let inputValue = input.value;

        // Check if the input value already starts with "+"
        if (inputValue.charAt(0) !== '+') {
            input.value = '+' + inputValue;
        } else {
            // If there's more than one "+", remove additional "+" characters
            input.value = '+' + inputValue.replace(/\+/g, '');
        }
    }
</script>
{% if form.phone_number.value %}
<script>

    let fullPhoneNumber = "{{ form.phone_number.value }}";

if (!fullPhoneNumber.startsWith('+')) {
    fullPhoneNumber = '+' + fullPhoneNumber;
}

    function autoFill() {
        const input = document.querySelector("#id_phone_number");
        input.value = fullPhoneNumber;
    }

    autoFill();

    const phoneInput = document.querySelector("#id_phone_number");

    // Initialize intl-tel-input
    const iti = window.intlTelInput(phoneInput, {
        utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",
        preferredCountries: ["xk", "al"], // Set your preferred countries here
        formatOnDisplay: false, // Disable auto-formatting
    });

    // Listen for changes to the selected country
    iti.promise.then(function () {
        iti.setNumber(fullPhoneNumber); // Set the full phone number including the country code
    });

    // Listen for input changes and update the formatted phone number
    phoneInput.addEventListener("input", function () {
        const phoneNumber = iti.getNumber();
    });
</script>

{% else %}
<script>
        const phoneInput = document.querySelector("#id_phone_number");

        // Initialize intl-tel-input
        const iti = window.intlTelInput(phoneInput, {
            utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",
            preferredCountries: ["xk", "al"], // Set your preferred countries here
            formatOnDisplay: false, // Disable auto-formatting
        });

        // Listen for changes to the selected country
        iti.promise.then(function () {
            const selectedCountryData = iti.getSelectedCountryData();

            // Update the input field with the country code when the country changes
            const countryCode = selectedCountryData.dialCode;
            phoneInput.value = "+" + countryCode;
        });

        // Listen for input changes and update the formatted phone number
        phoneInput.addEventListener("input", function () {
            const phoneNumber = iti.getNumber();
        });
    </script>

{% endif %}

<script>
        const countries = ["Kosovo","Albania","Afghanistan",
  "Algeria",
  "Andorra",
  "Angola",
  "Antigua and Barbuda",
  "Argentina",
  "Armenia",
  "Australia",
  "Austria",
  "Azerbaijan",
  "The Bahamas",
  "Bahrain",
  "Bangladesh",
  "Barbados",
  "Belarus",
  "Belgium",
  "Belize",
  "Benin",
  "Bhutan",
  "Bolivia",
  "Bosnia and Herzegovina",
  "Botswana",
  "Brazil",
  "Brunei",
  "Bulgaria",
  "Burkina Faso",
  "Burundi",
  "Cambodia",
  "Cameroon",
  "Canada",
  "Cape Verde",
  "Central African Republic",
  "Chad",
  "Chile",
  "China",
  "Colombia",
  "Comoros",
  "Republic of the Congo",
  "Democratic Republic of the Congo",
  "Costa Rica",
  "Croatia",
  "Cuba",
  "Cyprus",
  "Czech Republic",
  "Denmark",
  "Djibouti",
  "Dominica",
  "Dominican Republic",
  "East Timor",
  "Ecuador",
  "Egypt",
  "El Salvador",
  "Equatorial Guinea",
  "Eritrea",
  "Estonia",
  "Eswatini",
  "Ethiopia",
  "Fiji",
  "Finland",
  "France",
  "Gabon",
  "The Gambia",
  "Georgia",
  "Germany",
  "Ghana",
  "Greece",
  "Grenada",
  "Guatemala",
  "Guinea",
  "Guinea-Bissau",
  "Guyana",
  "Haiti",
  "Holy See (Vatican City)",
  "Honduras",
  "Hungary",
  "Iceland",
  "India",
  "Indonesia",
  "Iran",
  "Iraq",
  "Ireland",
  "Israel",
  "Italy",
  "Ivory Coast",
  "Jamaica",
  "Japan",
  "Jordan",
  "Kazakhstan",
  "Kenya",
  "Kiribati",
  "North Korea",
  "South Korea",
  "Kuwait",
  "Kyrgyzstan",
  "Laos",
  "Latvia",
  "Lebanon",
  "Lesotho",
  "Liberia",
  "Libya",
  "Liechtenstein",
  "Lithuania",
  "Luxembourg",
  "Madagascar",
  "Malawi",
  "Malaysia",
  "Maldives",
  "Mali",
  "Malta",
  "Marshall Islands",
  "Mauritania",
  "Mauritius",
  "Mexico",
  "Micronesia",
  "Moldova",
  "Monaco",
  "Mongolia",
  "Montenegro",
  "Morocco",
  "Mozambique",
  "Myanmar (Burma)",
  "Namibia",
  "Nauru",
  "Nepal",
  "Netherlands",
  "New Zealand",
  "Nicaragua",
  "Niger",
  "Nigeria",
  "North Macedonia",
  "Norway",
  "Oman",
  "Pakistan",
  "Palau",
  "Palestine",
  "Panama",
  "Papua New Guinea",
  "Paraguay",
  "Peru",
  "Philippines",
  "Poland",
  "Portugal",
  "Qatar",
  "Romania",
  "Russia",
  "Rwanda",
  "Saint Kitts and Nevis",
  "Saint Lucia",
  "Saint Vincent and the Grenadines",
  "Samoa",
  "San Marino",
  "São Tomé and Príncipe",
  "Saudi Arabia",
  "Senegal",
  "Serbia",
  "Seychelles",
  "Sierra Leone",
  "Singapore",
  "Slovakia",
  "Slovenia",
  "Solomon Islands",
  "Somalia",
  "South Africa",
  "South Sudan",
  "Spain",
  "Sri Lanka",
  "Sudan",
  "Suriname",
  "Sweden",
  "Switzerland",
  "Syria",
  "Tajikistan",
  "Tanzania",
  "Thailand",
  "Togo",
  "Tonga",
  "Trinidad and Tobago",
  "Tunisia",
  "Turkey",
  "Turkmenistan",
  "Tuvalu",
  "Uganda",
  "Ukraine",
  "United Arab Emirates",
  "United Kingdom",
  "United States",
  "Uruguay",
  "Uzbekistan",
  "Vanuatu",
  "Venezuela",
  "Vietnam",
  "Yemen",
  "Zambia",
  "Zimbabwe"
];

        var selectedCountry = "{{form.country.value}}";
        console.log(selectedCountry);
var select = document.getElementById("id_country");

// Function to populate the select element with countries
function populateCountries() {
    for (var i = 0; i < countries.length; i++) {
        var option = document.createElement("option");
        option.text = countries[i];
        select.appendChild(option);
    }

    // Check if selectedCountry is not null
    if (selectedCountry !== null) {
        // Loop through the <select> options
        for (var i = 0; i < select.options.length; i++) {
            // Check if the option's text matches the selectedCountry
            if (select.options[i].text === selectedCountry) {
                // Set the selected option
                select.selectedIndex = i;
                checkInputs();
                break; // Exit the loop
            }
        }
    }
}



function populateCountries1() {
  const select = document.getElementById("id_Country");

  for (const country of countries) {
    const option = document.createElement("option");
    option.value = country;
    option.text = country;
    select.appendChild(option);
  }
}
function populateCountries2() {
  const select = document.getElementById("id_country_e");

  for (const country of countries) {
    const option = document.createElement("option");
    option.value = country;
    option.text = country;
    select.appendChild(option);
  }
}

// Call the function to populate the select element
populateCountries1();
populateCountries2();
// Call the function to populate the select element when the page loads
window.addEventListener("load", populateCountries);
</script>