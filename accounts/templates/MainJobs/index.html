{% extends 'base.html' %}
{% block title %}Jobs{% endblock %}
{% block description %}The easiest and fastest way to find a temporary job abroad.{% endblock %}

{% load static %}
{% block content %}
{% include "Filters/filters.html"%}
{% if check %}
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<input type="hidden" id="PostID" value="{{post_id}}">
<input type="hidden" id="MainJobs" name="variable" value=True>
<script src="https://ajax.googleapis.com/ajax/libs/handlebars/4.7.7/handlebars.min.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCGdAo48zrdXuutzUUc0fVSrWCzi0Kn5OE&callback=initMap&libraries=places,geometry&solution_channel=GMP_QB_locatorplus_v6_cAF" async defer></script>


<div class="jobs-main-div jobs-gigs-main-div" style="display: flex; justify-content: space-between;">

  <div class="job-left" id="detailsRow" style="">
    {% include "MainJobs/left-jobs.html" %}
    </div>
    {% include "MainJobs/right-jobs.html" %}
</div>
{% else %}
    <div class="job-first-row NoResult" style="">No results were found</div>
{% endif %}
<script>
    $(document).ready(function() {
        $('.job-left-row').eq(0).click();
        if (window.innerWidth <= 768){
            $('.right-jobs, .right-jobs-main-div').hide();
        }
    });
</script>
<script>
    function showElements(shouldShowLeftJobs) {
        const elementsToShow = shouldShowLeftJobs ? '.job-left, .profileHeader, .header-wishes, .jobs-buttons' : '.right-jobs, .right-jobs-main-div';
        console.log("------------------");
        console.log("------------------");
        console.log(shouldShowLeftJobs);
        console.log("------------------");
        console.log("------------------");
        if (window.matchMedia('(max-width: 480px)').matches) {
            if (shouldShowLeftJobs) {
                $('.job-left, .profileHeader, .header-wishes, .jobs-buttons').show();
                $('.right-jobs, .right-jobs-main-div').hide();
            } else {
                $('.job-left, .profileHeader, .header-wishes, .jobs-buttons').hide();
                $('.right-jobs, .right-jobs-main-div').show();
            }
        } else {
            $(elementsToShow).show();
        }
    }

    function updateHistoryURL(id) {
        const newURL = window.location.origin + "/jobs" + (id ? '/' + id : '');
        history.pushState({ showJobLeft: !id }, '', newURL);
    }

    function initialize() {
        const post_id = '{{post_id}}';
        updateHistoryURL(post_id);

        $('.job-left-row').click(function() {
            const id = $(this).attr('id').substring("select".length);
            updateHistoryURL(id);
            showElements(false);
        });

        $('.job-right-exit').click(function() {
            updateHistoryURL();
            showElements(true);
        });

        // Add more event handlers as needed
    }

    // Handle popstate for mobile
    window.addEventListener('popstate', function(event) {
        if (event.state !== null) {
            showElements(event.state.showJobLeft);
        }
    });

    // Initial setup based on the screen width
    if (window.matchMedia('(max-width: 480px)').matches) {
        showElements(true); // Ensure right jobs are initially hidden on mobile

        initialize();
    } else {
        $(document).ready(initialize);
    }

    // Additional code to handle initial history state
    window.addEventListener('load', function() {
        showElements(history.state && history.state.showJobLeft !== true);
    });
</script>











<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/handlebars/4.7.7/handlebars.min.js"></script>



<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCGdAo48zrdXuutzUUc0fVSrWCzi0Kn5OE&callback=initMap&libraries=places,geometry&solution_channel=GMP_QB_locatorplus_v6_cAF" async defer></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

{% endblock content %}